<div style="max-width: 900px; margin: 0 auto; padding: 20px;">
  <h1 style="font-size: 2em; margin-bottom: 20px;">Invocation Details</h1>

  <%= link_to "← Back", agent_invocations_path, style: "margin-bottom: 20px; display: inline-block;" %>

  <div style="background: white; padding: 30px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 20px;">
    <div style="margin-bottom: 20px;">
      <h2 style="font-size: 1.5em; margin-bottom: 10px;">
        <%= link_to @invocation.agent.name, agent_path(@invocation.agent), style: "color: #2196f3; text-decoration: none;" %>
        <span style="color: #999; font-size: 0.8em;">(Agent #<%= @invocation.agent.agent_number %>)</span>
      </h2>
    </div>

    <div style="margin-bottom: 20px;">
      <strong>Task Description:</strong>
      <div style="background: #f5f5f5; padding: 15px; border-radius: 5px; margin-top: 5px;">
        <%= simple_format(@invocation.task_description) %>
      </div>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
      <div style="background: #f3e5f5; padding: 15px; border-radius: 5px;">
        <div style="font-size: 0.9em; color: #666;">Mode</div>
        <div style="font-weight: bold;"><%= @invocation.invocation_mode.humanize %></div>
      </div>

      <div style="background: #e3f2fd; padding: 15px; border-radius: 5px;">
        <div style="font-size: 0.9em; color: #666;">Started</div>
        <div style="font-weight: bold;"><%= @invocation.started_at.strftime("%b %d, %Y %H:%M") %></div>
      </div>

      <% if @invocation.completed_at %>
        <div style="background: #e8f5e9; padding: 15px; border-radius: 5px;">
          <div style="font-size: 0.9em; color: #666;">Completed</div>
          <div style="font-weight: bold;"><%= @invocation.completed_at.strftime("%b %d, %Y %H:%M") %></div>
        </div>

        <div style="background: #fff3e0; padding: 15px; border-radius: 5px;">
          <div style="font-size: 0.9em; color: #666;">Duration</div>
          <div style="font-weight: bold;"><%= @invocation.duration_display %></div>
        </div>
      <% end %>

      <% unless @invocation.success.nil? %>
        <div style="background: <%= @invocation.success ? '#e8f5e9' : '#ffebee' %>; padding: 15px; border-radius: 5px;">
          <div style="font-size: 0.9em; color: #666;">Success</div>
          <div style="font-weight: bold; color: <%= @invocation.success ? 'green' : 'red' %>;">
            <%= @invocation.success_label %>
          </div>
        </div>
      <% end %>

      <% if @invocation.satisfaction_rating %>
        <div style="background: #f1f8e9; padding: 15px; border-radius: 5px;">
          <div style="font-size: 0.9em; color: #666;">Rating</div>
          <div style="font-weight: bold;"><%= @invocation.rating_stars %></div>
        </div>
      <% end %>
    </div>

    <% if @invocation.context_notes.present? %>
      <div style="margin-bottom: 20px;">
        <strong>Context Notes:</strong>
        <div style="background: #f5f5f5; padding: 15px; border-radius: 5px; margin-top: 5px;">
          <%= simple_format(@invocation.context_notes) %>
        </div>
      </div>
    <% end %>

    <% if @invocation.outcome_notes.present? %>
      <div style="margin-bottom: 20px;">
        <strong>Outcome Notes:</strong>
        <div style="background: #f5f5f5; padding: 15px; border-radius: 5px; margin-top: 5px;">
          <%= simple_format(@invocation.outcome_notes) %>
        </div>
      </div>
    <% end %>

    <% if @invocation.tokens_total %>
      <div style="margin-bottom: 20px; padding: 15px; background: #fce4ec; border-radius: 5px;">
        <strong>Token Usage:</strong>
        <div style="margin-top: 5px;">
          Input: <%= number_with_delimiter(@invocation.tokens_input || 0) %> |
          Output: <%= number_with_delimiter(@invocation.tokens_output || 0) %> |
          Total: <%= number_with_delimiter(@invocation.tokens_total) %>
        </div>
      </div>
    <% end %>
  </div>
</div>
